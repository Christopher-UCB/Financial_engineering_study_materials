**严锦  1700011049**

**1.**

(1). 

每个磁盘页块可以储存$1024/16=64$个记录，其中第$1$个记录用于存放线性索引，还可以储存$63$个记录。内存共有$256K$，每个索引项为$8$字节，因此内存中共能存放$256*1024/8=32768$个索引。每个索引对应一个磁盘页块中的索引，对应$63$个记录，因此共能存放$32768*63=2064384$个记录。

![image-20181225103759865](https://ws1.sinaimg.cn/large/006tNbRwly1fyishv8sh8j31e80ko0ua.jpg)

(2). 

内存中由二级索引占据$1K$，还剩$255K$，共能存放$255*1024/8=32640$个索引，对应$32640*63=2056320$个记录。

![image-20181225105414844](https://ws1.sinaimg.cn/large/006tNbRwly1fyisyqjc6aj31d00s8tbl.jpg)

**2.**

| Department | ID#                    |
| ---------- | ---------------------- |
| 软件工程   | 1201, 1204, 1205, 1208 |
| 智能       | 1202, 1209, 1210       |
| 计算所     | 1203, 1207             |
| 元培       | 1206                   |

| Dormitory | ID#              |
| --------- | ---------------- |
| D41       | 1201, 1205, 1208 |
| D42       | 1204, 1209       |
| D46       | 1202, 1203, 1206 |
| D48       | 1207, 1210       |

| Age  | ID#                    |
| ---- | ---------------------- |
| 22   | 1203, 1207, 1210       |
| 23   | 1201, 1202, 1206, 1209 |
| 24   | 1204, 1205, 1208       |

**3.**

10000个关键码的B树共有10001个外部节点，设外部节点在第k层。因为B树第0层有1个节点，第1层至少有2个节点，此后每个节点都至少有42/2=21个子节点。因此第k层至少有$2*21^{k-1} = 10001$个节点，因此k=3.79。因此查找路径最长为4，最短为1。

**4.**

![image-20181225223518720](https://ws4.sinaimg.cn/large/006tNbRwly1fyjd88sbinj315c0u079t.jpg)

**5.**

(1). 第1次读18、33， 第2次读23、30，第3次读20、21，共进行3次读盘

(2). 第1次读18、33， 第2次读23、30，第3次读20、21，第4次读盘读到空节点，共进行4次读盘

(3). 

![image-20181225220134817](https://ws3.sinaimg.cn/large/006tNbRwly1fyjc9467lmj30u00vd78b.jpg)

![image-20181225220310400](https://ws2.sinaimg.cn/large/006tNbRwly1fyjcarpwrej30xo0h4gn1.jpg)

找到22插入位置的过程共读盘3次，插入22、关键码21上移、分裂出22、关键码23上移、分裂出30、新建根节点23、分裂出33，共写入7次.

共有10次访外操作。

(4). 

假设包括根节点在内，每一层都要分裂。每分裂一个非根节点要写出2个节点，分裂根节点要写出3个节点。对于h层B树，最多需要读盘h次，最多需要分裂h-1个非根节点和1个根节点，因此最多共需要h+2(h-1)+3=3h+1次读写操作。